<!--
SecureLink Pro - Client-Side URL Encryption Tool
Copyright (c) [Year] [Your Name/Company]

License: MIT License

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.

Security Notice: This tool provides client-side encryption. Users should be aware
that encoded URLs can still be accessed by anyone with the link. Use responsibly.
-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üîí SecureLink Pro</title>
    <style>
        :root {
            --bg-primary: #0a0a0f;
            --bg-secondary: #13131f;
            --bg-tertiary: #1c1c2e;
            --accent-primary: #7c3aed;
            --accent-secondary: #10b981;
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --border: #2d3748;
            --shadow: rgba(0, 0, 0, 0.6);
            --success: #10b981;
            --error: #ef4444;
            --warning: #f59e0b;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            overflow-x: hidden;
        }

        .container {
            width: 100%;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        /* Header */
        header {
            text-align: center;
            padding: 40px 20px;
            margin-bottom: 20px;
        }

        .logo {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 15px;
            margin-bottom: 15px;
        }

        .logo-icon {
            font-size: 42px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        h1 {
            font-size: 2.8rem;
            font-weight: 800;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            letter-spacing: -0.5px;
        }

        .tagline {
            color: var(--text-secondary);
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Main Card */
        .main-card {
            background: var(--bg-secondary);
            border-radius: 24px;
            overflow: hidden;
            box-shadow: 0 25px 75px var(--shadow);
            border: 1px solid var(--border);
            flex: 1;
            display: flex;
            flex-direction: column;
            margin-bottom: 40px;
        }

        /* Tabs Navigation */
        .tabs-nav {
            display: flex;
            background: rgba(28, 28, 46, 0.9);
            backdrop-filter: blur(10px);
            border-bottom: 1px solid var(--border);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .tab-btn {
            flex: 1;
            padding: 22px 20px;
            background: transparent;
            border: none;
            color: var(--text-secondary);
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            position: relative;
        }

        .tab-btn:hover {
            background: rgba(124, 58, 237, 0.1);
            color: var(--text-primary);
        }

        .tab-btn.active {
            color: var(--text-primary);
        }

        .tab-btn.active::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background: linear-gradient(90deg, var(--accent-primary), var(--accent-secondary));
            border-radius: 3px 3px 0 0;
        }

        .tab-icon {
            font-size: 1.2rem;
        }

        /* Content Area */
        .content-area {
            padding: 40px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .tab-content {
            display: none;
            flex: 1;
            animation: fadeIn 0.4s ease-out;
        }

        .tab-content.active {
            display: flex;
            flex-direction: column;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        /* Input Groups */
        .input-group {
            margin-bottom: 30px;
        }

        .input-label {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 12px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 1rem;
        }

        .label-icon {
            color: var(--accent-primary);
            font-size: 1.1rem;
        }

        .input-wrapper {
            position: relative;
        }

        input, textarea {
            width: 100%;
            padding: 18px 20px;
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            border-radius: 14px;
            color: var(--text-primary);
            font-size: 1rem;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        input:focus, textarea:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 4px rgba(124, 58, 237, 0.1);
        }

        textarea {
            min-height: 140px;
            resize: vertical;
            line-height: 1.5;
        }

        .input-hint {
            display: block;
            margin-top: 8px;
            color: var(--text-secondary);
            font-size: 0.9rem;
            line-height: 1.4;
        }

        /* Action Buttons */
        .action-btn {
            padding: 20px 30px;
            background: linear-gradient(135deg, var(--accent-primary), var(--accent-secondary));
            color: white;
            border: none;
            border-radius: 14px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-top: 10px;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 15px 35px rgba(124, 58, 237, 0.25);
        }

        .action-btn:active {
            transform: translateY(0);
        }

        .btn-icon {
            font-size: 1.2rem;
        }

        /* Loading States */
        .loading {
            display: none;
            text-align: center;
            padding: 40px;
        }

        .loading.active {
            display: block;
        }

        .spinner {
            width: 48px;
            height: 48px;
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }

        .loading-text {
            color: var(--text-secondary);
            font-size: 1rem;
            font-weight: 500;
        }

        /* Results */
        .result-container {
            margin-top: 30px;
            display: none;
            animation: slideUp 0.4s ease-out;
        }

        .result-container.active {
            display: block;
        }

        @keyframes slideUp {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .result-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 15px;
        }

        .result-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-primary);
            font-weight: 600;
            font-size: 1.1rem;
        }

        .result-box {
            background: var(--bg-tertiary);
            border: 2px solid var(--border);
            border-radius: 14px;
            padding: 20px;
            word-break: break-all;
            font-family: 'Consolas', 'Monaco', monospace;
            font-size: 0.95rem;
            line-height: 1.6;
            position: relative;
            padding-right: 60px;
            min-height: 80px;
            display: flex;
            align-items: center;
        }

        .copy-btn {
            position: absolute;
            right: 15px;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(124, 58, 237, 0.1);
            border: 2px solid var(--accent-primary);
            color: var(--accent-primary);
            padding: 10px 18px;
            border-radius: 10px;
            cursor: pointer;
            font-size: 0.9rem;
            font-weight: 600;
            display: flex;
            align-items: center;
            gap: 8px;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            background: rgba(124, 58, 237, 0.2);
        }

        .copy-btn.copied {
            background: var(--success);
            border-color: var(--success);
            color: white;
        }

        /* Footer */
        footer {
            text-align: center;
            padding: 30px 20px;
            color: var(--text-secondary);
            font-size: 0.95rem;
            border-top: 1px solid var(--border);
            margin-top: auto;
        }

        .footer-content {
            max-width: 600px;
            margin: 0 auto;
            line-height: 1.6;
        }

        /* Redirect Overlay */
        .redirect-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-primary);
            display: none;
            align-items: center;
            justify-content: center;
            z-index: 1000;
            flex-direction: column;
            padding: 20px;
        }

        .redirect-overlay.active {
            display: flex;
        }

        .redirect-spinner {
            width: 60px;
            height: 60px;
            border: 4px solid rgba(255, 255, 255, 0.1);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: 25px;
        }

        .redirect-text {
            color: var(--text-primary);
            font-size: 1.2rem;
            font-weight: 600;
            margin-bottom: 10px;
        }

        .redirect-subtext {
            color: var(--text-secondary);
            font-size: 1rem;
            text-align: center;
            max-width: 400px;
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            header {
                padding: 30px 15px;
            }

            h1 {
                font-size: 2.2rem;
            }

            .tabs-nav {
                flex-direction: column;
            }

            .tab-btn {
                padding: 18px 15px;
                justify-content: flex-start;
                border-bottom: 1px solid rgba(45, 55, 72, 0.5);
            }

            .tab-btn.active::after {
                height: 100%;
                width: 4px;
                border-radius: 0 3px 3px 0;
                left: auto;
                right: 0;
            }

            .content-area {
                padding: 25px;
            }

            .result-box {
                padding-right: 15px;
                padding-bottom: 60px;
            }

            .copy-btn {
                position: static;
                transform: none;
                margin-top: 15px;
                width: 100%;
                justify-content: center;
            }

            input, textarea {
                padding: 16px;
                font-size: 16px; /* Prevents iOS zoom */
            }

            .action-btn {
                padding: 18px 20px;
            }
        }

        @media (max-width: 480px) {
            h1 {
                font-size: 1.8rem;
            }

            .tagline {
                font-size: 1rem;
            }

            .content-area {
                padding: 20px;
            }

            .logo-icon {
                font-size: 36px;
            }
        }

        /* Accessibility */
        @media (prefers-reduced-motion: reduce) {
            * {
                animation-duration: 0.01ms !important;
                animation-iteration-count: 1 !important;
                transition-duration: 0.01ms !important;
            }
        }

        /* Dark mode adjustments */
        @media (prefers-color-scheme: dark) {
            :root {
                --bg-primary: #0a0a0f;
                --bg-secondary: #13131f;
            }
        }

        /* High contrast mode */
        @media (prefers-contrast: high) {
            :root {
                --border: #ffffff;
                --text-primary: #ffffff;
                --text-secondary: #cccccc;
            }
        }
    </style>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <div class="container">
        <header>
            <div class="logo">
                <div class="logo-icon">
                    <i class="fas fa-fingerprint"></i>
                </div>
                <h1>SecureLink Pro</h1>
            </div>
            <p class="tagline">Advanced client-side URL encryption with instant, silent redirection</p>
        </header>

        <div class="main-card">
            <nav class="tabs-nav">
                <button class="tab-btn active" data-tab="encode">
                    <i class="fas fa-lock tab-icon"></i>
                    <span>Encode URL</span>
                </button>
                <button class="tab-btn" data-tab="decode">
                    <i class="fas fa-unlock tab-icon"></i>
                    <span>Decode & Redirect</span>
                </button>
            </nav>

            <div class="content-area">
                <!-- Encode Tab -->
                <div id="encode-tab" class="tab-content active">
                    <div class="input-group">
                        <label class="input-label">
                            <i class="fas fa-link label-icon"></i>
                            <span>Target URL</span>
                        </label>
                        <div class="input-wrapper">
                            <input type="url" id="encode-input" placeholder="https://example.com" autocomplete="off" spellcheck="false">
                        </div>
                        <span class="input-hint">Enter the destination URL you want to encode</span>
                    </div>

                    <button id="encode-btn" class="action-btn">
                        <i class="fas fa-shield-alt btn-icon"></i>
                        <span>Generate Secure Link</span>
                    </button>

                    <div class="loading" id="encode-loading">
                        <div class="spinner"></div>
                        <p class="loading-text">Encrypting URL with military-grade security...</p>
                    </div>

                    <div class="result-container" id="encode-result">
                        <div class="result-header">
                            <div class="result-title">
                                <i class="fas fa-qrcode"></i>
                                <span>Your Secure Link</span>
                            </div>
                        </div>
                        <div class="result-box">
                            <span id="encoded-output"></span>
                            <button class="copy-btn" id="copy-encoded-btn">
                                <i class="far fa-copy"></i>
                                <span>Copy</span>
                            </button>
                        </div>
                    </div>
                </div>

                <!-- Decode Tab -->
                <div id="decode-tab" class="tab-content">
                    <div class="input-group">
                        <label class="input-label">
                            <i class="fas fa-code label-icon"></i>
                            <span>Encoded Link</span>
                        </label>
                        <div class="input-wrapper">
                            <textarea id="decode-input" placeholder="Paste the encoded link here..." autocomplete="off" spellcheck="false"></textarea>
                        </div>
                        <span class="input-hint">Paste the secure link to instantly redirect to the original URL</span>
                    </div>

                    <button id="decode-btn" class="action-btn">
                        <i class="fas fa-external-link-alt btn-icon"></i>
                        <span>Process & Redirect</span>
                    </button>

                    <div class="loading" id="decode-loading">
                        <div class="spinner"></div>
                        <p class="loading-text">Decrypting and preparing redirect...</p>
                    </div>
                </div>
            </div>
        </div>

        <footer>
            <div class="footer-content">
                <p><i class="fas fa-shield-alt"></i> All encryption happens in your browser ‚Ä¢ No data stored ‚Ä¢ No server communication</p>
                <p>SecureLink Pro v3 ‚Ä¢ Advanced client-side security</p>
                <div class="legal-links" style="margin-top: 15px; font-size: 0.9rem;">
                    <a href="privacy.html" style="color: var(--text-secondary); margin: 0 10px;">Privacy Policy</a>
                    <a href="terms.html" style="color: var(--text-secondary); margin: 0 10px;">Terms of Service</a>
                    <a href="#disclaimer-modal" style="color: var(--text-secondary); margin: 0 10px;" onclick="showDisclaimer()">Disclaimer</a>
                </div>
            </div>
        </footer>
    </div>

    <!-- Redirect Overlay -->
    <div class="redirect-overlay" id="redirect-overlay">
        <div class="redirect-spinner"></div>
        <div class="redirect-text">Redirecting securely...</div>
        <div class="redirect-subtext">You are being redirected to the destination URL</div>
    </div>

    <!-- Disclaimer Modal -->
    <div id="disclaimer-modal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); z-index: 2000; align-items: center; justify-content: center;">
        <div style="background: var(--bg-secondary); padding: 30px; border-radius: 15px; max-width: 500px; margin: 20px;">
            <h3 style="margin-bottom: 15px; color: var(--accent-primary);">‚ö†Ô∏è Important Disclaimer</h3>
            <p style="margin-bottom: 15px; line-height: 1.6;">This tool provides client-side URL obfuscation. It is not intended for:</p>
            <ul style="margin-bottom: 20px; padding-left: 20px;">
                <li>Illegal activities</li>
                <li>Bypassing security systems</li>
                <li>Concealing malicious links</li>
                <li>Copyright infringement</li>
            </ul>
            <p style="margin-bottom: 20px; font-size: 0.9rem; color: var(--text-secondary);">Use responsibly. The creator is not liable for misuse.</p>
            <button onclick="hideDisclaimer()" style="padding: 10px 20px; background: var(--accent-primary); color: white; border: none; border-radius: 8px; cursor: pointer;">I Understand</button>
        </div>
    </div>

<script>
    // Fixed Encryption System
    // SIMPLE BUT RELIABLE ENCRYPTION SYSTEM
class SimpleSecureLink {
    constructor() {
        // Fixed encryption key - MUST BE THE SAME for encode/decode
        this.fixedKey = "my-secure-fixed-key-12345-!@#$";
    }

    async encode(text) {
        try {
            // Convert text to bytes
            const encoder = new TextEncoder();
            const data = encoder.encode(text);
            
            // Derive key from fixed string
            const keyMaterial = await crypto.subtle.importKey(
                "raw",
                new TextEncoder().encode(this.fixedKey),
                { name: "PBKDF2" },
                false,
                ["deriveKey"]
            );
            
            const key = await crypto.subtle.deriveKey(
                {
                    name: "PBKDF2",
                    salt: new TextEncoder().encode("secure-salt"),
                    iterations: 100000,
                    hash: "SHA-256"
                },
                keyMaterial,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt", "decrypt"]
            );
            
            // Generate IV
            const iv = crypto.getRandomValues(new Uint8Array(12));
            
            // Encrypt
            const encrypted = await crypto.subtle.encrypt(
                {
                    name: "AES-GCM",
                    iv: iv
                },
                key,
                data
            );
            
            // Combine IV + encrypted data
            const combined = new Uint8Array(iv.length + encrypted.byteLength);
            combined.set(iv);
            combined.set(new Uint8Array(encrypted), iv.length);
            
            // Convert to URL-safe base64
            const base64 = btoa(String.fromCharCode(...combined));
            return base64
                .replace(/\+/g, '-')
                .replace(/\//g, '_')
                .replace(/=/g, '');
                
        } catch (error) {
            console.error('Encode error:', error);
            throw error;
        }
    }

    async decode(encoded) {
        try {
            // Decode from URL-safe base64
            let base64 = encoded.replace(/-/g, '+').replace(/_/g, '/');
            
            // Add padding
            while (base64.length % 4) {
                base64 += '=';
            }
            
            // Convert to bytes
            const binary = atob(base64);
            const bytes = new Uint8Array(binary.length);
            for (let i = 0; i < binary.length; i++) {
                bytes[i] = binary.charCodeAt(i);
            }
            
            // Extract IV (first 12 bytes) and encrypted data
            const iv = bytes.slice(0, 12);
            const encrypted = bytes.slice(12);
            
            // Derive key (same as encode)
            const keyMaterial = await crypto.subtle.importKey(
                "raw",
                new TextEncoder().encode(this.fixedKey),
                { name: "PBKDF2" },
                false,
                ["deriveKey"]
            );
            
            const key = await crypto.subtle.deriveKey(
                {
                    name: "PBKDF2",
                    salt: new TextEncoder().encode("secure-salt"),
                    iterations: 100000,
                    hash: "SHA-256"
                },
                keyMaterial,
                { name: "AES-GCM", length: 256 },
                false,
                ["encrypt", "decrypt"]
            );
            
            // Decrypt
            const decrypted = await crypto.subtle.decrypt(
                {
                    name: "AES-GCM",
                    iv: iv
                },
                key,
                encrypted
            );
            
            return new TextDecoder().decode(decrypted);
            
        } catch (error) {
            console.error('Decode error:', error);
            throw new Error('Invalid or corrupted link');
        }
    }

    validateURL(url) {
        // Simple URL validation
        return url.startsWith('http://') || url.startsWith('https://');
    }
}

// DOM Elements
const tabBtns = document.querySelectorAll('.tab-btn');
const encodeTab = document.getElementById('encode-tab');
const decodeTab = document.getElementById('decode-tab');
const encodeInput = document.getElementById('encode-input');
const decodeInput = document.getElementById('decode-input');
const encodeBtn = document.getElementById('encode-btn');
const decodeBtn = document.getElementById('decode-btn');
const encodeLoading = document.getElementById('encode-loading');
const decodeLoading = document.getElementById('decode-loading');
const encodeResult = document.getElementById('encode-result');
const encodedOutput = document.getElementById('encoded-output');
const copyEncodedBtn = document.getElementById('copy-encoded-btn');
const redirectOverlay = document.getElementById('redirect-overlay');

// Initialize
const secureLink = new SimpleSecureLink();

// Tab switching
tabBtns.forEach(btn => {
    btn.addEventListener('click', () => {
        const tabName = btn.dataset.tab;
        
        tabBtns.forEach(b => b.classList.remove('active'));
        btn.classList.add('active');
        
        encodeTab.classList.remove('active');
        decodeTab.classList.remove('active');
        document.getElementById(`${tabName}-tab`).classList.add('active');
        
        encodeLoading.classList.remove('active');
        decodeLoading.classList.remove('active');
        encodeResult.classList.remove('active');
        
        encodeBtn.style.display = 'flex';
        decodeBtn.style.display = 'flex';
    });
});

// Encode URL
encodeBtn.addEventListener('click', async () => {
    const url = encodeInput.value.trim();
    
    if (!url) {
        showToast('Please enter a URL', 'error');
        return;
    }
    
    let validUrl = url;
    if (!/^https?:\/\//i.test(validUrl)) {
        validUrl = 'https://' + validUrl;
    }
    
    if (!secureLink.validateURL(validUrl)) {
        showToast('Please enter a valid URL', 'error');
        return;
    }
    
    encodeLoading.classList.add('active');
    encodeBtn.style.display = 'none';
    
    try {
        const encoded = await secureLink.encode(validUrl);
        
        const baseUrl = window.location.origin + window.location.pathname;
        const cleanBase = baseUrl.replace(/\/[^\/]*\.html?$/, '').replace(/\/$/, '');
        const fullLink = `${cleanBase}/#${encoded}`;
        
        encodedOutput.textContent = fullLink;
        encodeResult.classList.add('active');
        encodeLoading.classList.remove('active');
        
        // Store in session for testing
        sessionStorage.setItem('lastEncoded', encoded);
        sessionStorage.setItem('lastOriginal', validUrl);
        
    } catch (error) {
        console.error('Encode failed:', error);
        showToast('Failed to encode URL', 'error');
        encodeLoading.classList.remove('active');
        encodeBtn.style.display = 'flex';
    }
});

// Decode and redirect
decodeBtn.addEventListener('click', async () => {
    const encodedLink = decodeInput.value.trim();
    
    if (!encodedLink) {
        showToast('Please paste an encoded link', 'error');
        return;
    }
    
    let encoded;
    if (encodedLink.includes('#')) {
        encoded = encodedLink.split('#')[1];
    } else {
        encoded = encodedLink;
    }
    
    if (!encoded) {
        showToast('Invalid encoded link format', 'error');
        return;
    }
    
    decodeLoading.classList.add('active');
    decodeBtn.style.display = 'none';
    
    try {
        console.log('Attempting to decode:', encoded.substring(0, 30) + '...');
        
        // Try decoding with current system
        const decodedUrl = await secureLink.decode(encoded);
        
        console.log('Decoded URL:', decodedUrl);
        
        if (!decodedUrl) {
            throw new Error('Decoded empty');
        }
        
        if (!secureLink.validateURL(decodedUrl)) {
            // Try adding https://
            const correctedUrl = 'https://' + decodedUrl;
            if (secureLink.validateURL(correctedUrl)) {
                redirectTo(correctedUrl);
                return;
            }
            throw new Error('Invalid URL format');
        }
        
        redirectTo(decodedUrl);
        
    } catch (error) {
        console.error('Decode error:', error);
        
        // Try to decode as base64 directly (for testing)
        try {
            let testBase64 = encoded.replace(/-/g, '+').replace(/_/g, '/');
            while (testBase64.length % 4) {
                testBase64 += '=';
            }
            const testDecoded = atob(testBase64);
            console.log('Direct base64 decode:', testDecoded.substring(0, 100));
            
            if (testDecoded.startsWith('http')) {
                showToast('Found URL via base64: ' + testDecoded.substring(0, 50) + '...', 'info');
                redirectTo(testDecoded);
                return;
            }
        } catch (e) {
            console.log('Base64 also failed');
        }
        
        showToast('Decryption failed. Link may be from different system.', 'error');
        decodeLoading.classList.remove('active');
        decodeBtn.style.display = 'flex';
    }
});

function redirectTo(url) {
    redirectOverlay.classList.add('active');
    
    // Add delay to show loading state
    setTimeout(() => {
        console.log('Redirecting to:', url);
        window.location.replace(url);
    }, 800);
}

// Copy encoded link
copyEncodedBtn.addEventListener('click', async () => {
    const text = encodedOutput.textContent;
    
    if (!text) return;
    
    try {
        await navigator.clipboard.writeText(text);
        copyEncodedBtn.classList.add('copied');
        copyEncodedBtn.innerHTML = '<i class="fas fa-check"></i><span>Copied</span>';
        
        setTimeout(() => {
            copyEncodedBtn.classList.remove('copied');
            copyEncodedBtn.innerHTML = '<i class="far fa-copy"></i><span>Copy</span>';
        }, 2000);
    } catch (error) {
        showToast('Failed to copy', 'error');
    }
});

// Handle direct links
window.addEventListener('load', async () => {
    const hash = window.location.hash.substring(1);
    
    if (hash) {
        // Switch to decode tab
        tabBtns.forEach(b => b.classList.remove('active'));
        document.querySelector('.tab-btn[data-tab="decode"]').classList.add('active');
        encodeTab.classList.remove('active');
        decodeTab.classList.add('active');
        
        // Auto-fill
        const baseUrl = window.location.origin + window.location.pathname;
        decodeInput.value = `${baseUrl}#${hash}`;
        
        // Auto-redirect
        setTimeout(async () => {
            try {
                decodeLoading.classList.add('active');
                const decodedUrl = await secureLink.decode(hash);
                
                if (decodedUrl && secureLink.validateURL(decodedUrl)) {
                    redirectTo(decodedUrl);
                } else {
                    showToast('Invalid direct link', 'error');
                    decodeLoading.classList.remove('active');
                }
            } catch (error) {
                console.error('Auto-decode failed:', error);
                decodeLoading.classList.remove('active');
            }
        }, 500);
    }
});

// Auto-decode on paste
decodeInput.addEventListener('paste', (e) => {
    setTimeout(() => {
        if (decodeInput.value.trim()) {
            decodeBtn.click();
        }
    }, 100);
});

// Toast notification
function showToast(message, type = 'info') {
    const toast = document.createElement('div');
    toast.textContent = message;
    toast.style.cssText = `
        position: fixed;
        bottom: 30px;
        left: 50%;
        transform: translateX(-50%) translateY(100px);
        background: ${type === 'error' ? '#ef4444' : type === 'info' ? '#3b82f6' : '#10b981'};
        color: white;
        padding: 15px 25px;
        border-radius: 12px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        z-index: 1000;
        opacity: 0;
        transition: all 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275);
        font-weight: 500;
        max-width: 90%;
        text-align: center;
    `;
    
    document.body.appendChild(toast);
    
    setTimeout(() => {
        toast.style.transform = 'translateX(-50%) translateY(0)';
        toast.style.opacity = '1';
    }, 10);
    
    setTimeout(() => {
        toast.style.transform = 'translateX(-50%) translateY(100px)';
        toast.style.opacity = '0';
        setTimeout(() => {
            document.body.removeChild(toast);
        }, 400);
    }, 3000);
}

// Initialize
encodeInput.focus();
</script>
</body>

</html>

